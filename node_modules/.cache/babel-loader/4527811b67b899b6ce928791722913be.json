{"ast":null,"code":"var _jsxFileName = \"/Users/andreashellberg/Desktop/skolan/inla\\u0308mining2/uppgift2/src/containers/TheForm.jsx\";\nimport React, { useContext, useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { UserContext } from \"../UserContext\";\nimport Input from \"../components/Input\";\nimport SelectInput from \"../components/SelectInput\";\nimport FormKit from \"../data/FormKit\";\nimport UserKit from \"../data/UserKit\";\nimport { updateCustomerList } from \"../utils\";\n\nconst TheForm = ({\n  type,\n  customer\n}) => {\n  const userKit = new UserKit();\n  const formKit = new FormKit();\n  const history = useHistory();\n  const [fieldValues, setFieldValues] = useState();\n  const {\n    setCurrentUser\n  } = useContext(UserContext);\n  const {\n    setCustomerList\n  } = useContext(UserContext); // depending on what type of form is requested\n  // initialFieldValues is set by the values collected from FormKit.js\n\n  useEffect(() => {\n    let form = formKit[type];\n    let initialFieldState = form.reduce((acc, cur) => {\n      return { ...acc,\n        [cur.name]: cur.options ? cur.options[0] : \"\"\n      };\n    }, {});\n    setFieldValues(initialFieldState);\n  }, []);\n  useEffect(() => {\n    customer && setFieldValues(customer);\n  }, []);\n\n  const handleChange = (name, value) => {\n    setFieldValues(prevState => {\n      return { ...prevState,\n        [name]: value\n      };\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n\n    switch (type) {\n      case type === \"register\":\n        userKit.register(fieldValues);\n        break;\n\n      default:\n        null;\n    }\n\n    type === \"register\" && type === \"login\" && userKit.login(fieldValues).then(res => res.json()).then(data => {\n      if (data.token) {\n        setCurrentUser(true);\n        userKit.setSessionToken(data.token);\n        history.push(\"/\");\n      }\n    });\n\n    if (type === \"addCustomer\" && !customer) {\n      userKit.addCustomer(fieldValues).then(() => updateCustomerList(userKit, setCustomerList));\n    }\n\n    customer && userKit.updateCustomer(customer.id, fieldValues).then(() => updateCustomerList(userKit, setCustomerList)).then(history.push(\"/\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 5\n    }\n  }, fieldValues && formKit[type].map(field => {\n    if (field.type === \"input\") {\n      return /*#__PURE__*/React.createElement(Input, {\n        name: field.name,\n        label: field.name,\n        value: fieldValues[field.name],\n        handleChange: handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 15\n        }\n      });\n    }\n\n    if (field.type === \"select\") {\n      return /*#__PURE__*/React.createElement(SelectInput, {\n        name: field.name,\n        label: field.name,\n        value: fieldValues[field.name],\n        handleChange: handleChange,\n        options: field.options,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }\n      });\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => handleSubmit(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, customer ? \"update\" : type));\n};\n\nexport default TheForm; //   type === \"register\" && userKit.register(fieldValues)\n//   type === \"login\" &&\n//     userKit\n//       .login(fieldValues)\n//       .then((res) => res.json())\n//       .then((data) => {\n//         if (data.token) {\n//           setCurrentUser(true)\n//           userKit.setSessionToken(data.token)\n//           history.push(\"/\")\n//         }\n//       })\n//   if (type === \"addCustomer\" && !customer) {\n//     userKit\n//       .addCustomer(fieldValues)\n//       .then(() => updateCustomerList(userKit, setCustomerList))\n//   }\n//   customer &&\n//     userKit\n//       .updateCustomer(customer.id, fieldValues)\n//       .then(() => updateCustomerList(userKit, setCustomerList))\n//       .then(history.push(\"/\"))\n// }","map":{"version":3,"sources":["/Users/andreashellberg/Desktop/skolan/inlaÌˆmining2/uppgift2/src/containers/TheForm.jsx"],"names":["React","useContext","useState","useEffect","useHistory","UserContext","Input","SelectInput","FormKit","UserKit","updateCustomerList","TheForm","type","customer","userKit","formKit","history","fieldValues","setFieldValues","setCurrentUser","setCustomerList","form","initialFieldState","reduce","acc","cur","name","options","handleChange","value","prevState","handleSubmit","e","preventDefault","register","login","then","res","json","data","token","setSessionToken","push","addCustomer","updateCustomer","id","map","field"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\"\nimport { useEffect } from \"react\"\nimport { useHistory } from \"react-router-dom\"\nimport { UserContext } from \"../UserContext\"\nimport Input from \"../components/Input\"\nimport SelectInput from \"../components/SelectInput\"\nimport FormKit from \"../data/FormKit\"\nimport UserKit from \"../data/UserKit\"\nimport { updateCustomerList } from \"../utils\"\n\nconst TheForm = ({ type, customer }) => {\n  const userKit = new UserKit()\n  const formKit = new FormKit()\n  const history = useHistory()\n  const [fieldValues, setFieldValues] = useState()\n\n  const { setCurrentUser } = useContext(UserContext)\n  const { setCustomerList } = useContext(UserContext)\n\n  // depending on what type of form is requested\n  // initialFieldValues is set by the values collected from FormKit.js\n  useEffect(() => {\n    let form = formKit[type]\n    let initialFieldState = form.reduce((acc, cur) => {\n      return {\n        ...acc,\n        [cur.name]: cur.options ? cur.options[0] : \"\",\n      }\n    }, {})\n    setFieldValues(initialFieldState)\n  }, [])\n\n  useEffect(() => {\n    customer && setFieldValues(customer)\n  }, [])\n\n  const handleChange = (name, value) => {\n    setFieldValues((prevState) => {\n      return {\n        ...prevState,\n        [name]: value,\n      }\n    })\n  }\n\n  const handleSubmit = (e) => {\n    e.preventDefault()\n    switch (type) {\n      case type === \"register\":\n        userKit.register(fieldValues)\n        break\n      default:\n        null\n    }\n    type === \"register\" &&\n      type === \"login\" &&\n      userKit\n        .login(fieldValues)\n        .then((res) => res.json())\n        .then((data) => {\n          if (data.token) {\n            setCurrentUser(true)\n            userKit.setSessionToken(data.token)\n            history.push(\"/\")\n          }\n        })\n    if (type === \"addCustomer\" && !customer) {\n      userKit\n        .addCustomer(fieldValues)\n        .then(() => updateCustomerList(userKit, setCustomerList))\n    }\n\n    customer &&\n      userKit\n        .updateCustomer(customer.id, fieldValues)\n        .then(() => updateCustomerList(userKit, setCustomerList))\n        .then(history.push(\"/\"))\n  }\n\n  return (\n    <form>\n      {fieldValues &&\n        formKit[type].map((field) => {\n          if (field.type === \"input\") {\n            return (\n              <Input\n                name={field.name}\n                label={field.name}\n                value={fieldValues[field.name]}\n                handleChange={handleChange}\n              ></Input>\n            )\n          }\n          if (field.type === \"select\") {\n            return (\n              <SelectInput\n                name={field.name}\n                label={field.name}\n                value={fieldValues[field.name]}\n                handleChange={handleChange}\n                options={field.options}\n              ></SelectInput>\n            )\n          }\n        })}\n      <button onClick={(e) => handleSubmit(e)}>\n        {customer ? \"update\" : type}\n      </button>\n    </form>\n  )\n}\n\nexport default TheForm\n\n//   type === \"register\" && userKit.register(fieldValues)\n//   type === \"login\" &&\n//     userKit\n//       .login(fieldValues)\n//       .then((res) => res.json())\n//       .then((data) => {\n//         if (data.token) {\n//           setCurrentUser(true)\n//           userKit.setSessionToken(data.token)\n//           history.push(\"/\")\n//         }\n//       })\n//   if (type === \"addCustomer\" && !customer) {\n//     userKit\n//       .addCustomer(fieldValues)\n//       .then(() => updateCustomerList(userKit, setCustomerList))\n//   }\n\n//   customer &&\n//     userKit\n//       .updateCustomer(customer.id, fieldValues)\n//       .then(() => updateCustomerList(userKit, setCustomerList))\n//       .then(history.push(\"/\"))\n// }\n"]},"metadata":{},"sourceType":"module"}